<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GOOPA STREAM OVERLAY</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Add a placeholder for the Twitch embed -->
  <div class="info-container">
    <h1>WCC Big Bud AUTO</h1>
  </div>
  <div id="lights-out">
    <h1>Lights Out!</h1>
    <p>Come back tomorrow!</p>
  </div>
  <div id="twitch-embed">
    <p>Lights are out! You are watching twitch.tv/goopagames</p>
  </div>
  
  <!-- Load the Twitch embed script -->
  <script src="https://player.twitch.tv/js/embed/v1.js"></script>

  <script type="text/javascript">
    const channelName = 'goopagames';
    function checkStreamStatus() {
      fetch(`https://api.twitch.tv/helix/streams?user_login=${channelName}`, {
        method: 'GET',
        headers: {
          'Client-Id': 'j3zzxaksr272v8o5443oi8ckg26g3c',
          'Authorization': 'Bearer vuyz6r9jyjq32xtmb28q4e8jr6fcej',
        }
      })
      .then(response => response.json())
      .then(data => {
        console.log('Success:', data.data.length);
        if (data.data.length !== 0) {
          document.getElementById('twitch-embed').classList.add('online');
        } else {
          document.getElementById('twitch-embed').classList.remove('online');
        }
      })
      .catch(error => console.error('Error:', error));
    }

    checkStreamStatus();
    setInterval(checkStreamStatus, 1 * 60 * 1000);

    function scheduleClassToggle(elementId, className) {
        const element = document.getElementById(elementId);

        function toggleClass() {
          const now = new Date();
          const currentHour = now.getHours();

          if (currentHour >= 19 || currentHour < 7) {
            element.classList.add(className);

          } else {
            element.classList.remove(className);
          }
        }

        // Initial check when the page loads
        toggleClass();

        // Check every minute to ensure the class is toggled at the right time
        setInterval(toggleClass, 60000); // 60000ms = 1 minute
      }

      // Usage: Replace 'yourElementId' and 'yourClassName' with the actual ID and class name
      scheduleClassToggle('twitch-embed', 'lights-off');
      scheduleClassToggle('lights-out', 'active');

      var options = {
        channel: channelName,
        // only needed if your site is also embedded on embed.example.com and othersite.example.com
        parent: ["chasemilligan.github.io"]
      };
      var player = new Twitch.Player("twitch-embed", options);
      player.setVolume(1);
  </script>
</body>
</html>

